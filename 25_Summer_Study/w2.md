# 📌 1. 12세 이하 여자 환자 목록 출력하기

## 문제 설명

`PATIENT` 테이블: 종합병원에 등록된 환자 정보

### 컬럼 정보

| 컬럼명      | 타입          | 설명              |
| -------- | ----------- | --------------- |
| PT\_NO   | VARCHAR(10) | 환자 번호           |
| PT\_NAME | VARCHAR(20) | 환자 이름           |
| GEND\_CD | VARCHAR(1)  | 성별 코드           |
| AGE      | INTEGER     | 나이              |
| TLNO     | VARCHAR(50) | 전화번호 (nullable) |

---

### 요구 사항

* **12세 이하**이고 **여자(`W`) 환자**만 조회
* 출력 컬럼: `PT_NAME`, `PT_NO`, `GEND_CD`, `AGE`, `TLNO`
* 전화번호가 없으면 `'NONE'`으로 출력
* 정렬 기준:

  * `AGE` 내림차순
  * `PT_NAME` 오름차순

---

## 문제 풀이

### 1. **조건부터 생각하기**

* 나이: `AGE <= 12`
* 성별: `GEND_CD = 'W'`

```sql
WHERE AGE <= 12 AND GEND_CD = 'W'
```

---

### 2. **전화번호가 없으면 'NONE' 처리하기**

#### 방법 1: `CASE WHEN`

```sql
CASE 
  WHEN TLNO IS NULL THEN 'NONE'
  ELSE TLNO
END AS TLNO
```

* 조건문으로 NULL 여부를 직접 체크
* 가장 명확한 방식이며 표준 SQL에서 사용 가능

#### 방법 2: `IFNULL()` 함수

```sql
IFNULL(TLNO, 'NONE') AS TLNO
```

* `TLNO`가 `NULL`이면 `'NONE'` 반환
* `CASE WHEN`을 짧게 축약한 MySQL 전용 함수
* 더 **간단하고 가독성 좋음**

---

### 3. **정렬 기준**

```sql
ORDER BY AGE DESC, PT_NAME ASC
```

* 나이가 많을수록 먼저
* 나이가 같을 경우 이름 오름차순

---

## 최종 SQL 쿼리

### ✅ `CASE WHEN` 사용 버전

```sql
SELECT 
  PT_NAME, 
  PT_NO, 
  GEND_CD, 
  AGE,
  CASE 
    WHEN TLNO IS NULL THEN 'NONE'
    ELSE TLNO
  END AS TLNO
FROM PATIENT
WHERE AGE <= 12 AND GEND_CD = 'W'
ORDER BY AGE DESC, PT_NAME ASC;
```

---

### ✅ `IFNULL()` 사용 버전 (더 간단한 MySQL 방식)

```sql
SELECT 
  PT_NAME, 
  PT_NO, 
  GEND_CD, 
  AGE,
  IFNULL(TLNO, 'NONE') AS TLNO
FROM PATIENT
WHERE AGE <= 12 AND GEND_CD = 'W'
ORDER BY AGE DESC, PT_NAME ASC;
```

---

## 🧠 `CASE WHEN` vs `IFNULL` 차이 설명

| 항목    | `CASE WHEN`                                        | `IFNULL()`              |
| ----- | -------------------------------------------------- | ----------------------- |
| 문법    | SQL 표준                                             | MySQL 전용 (Oracle에선 NVL) |
| 유연성   | 다양한 조건 (예: 범위, 복합 조건 등) 처리 가능                      | NULL 처리만 가능             |
| 사용 위치 | SELECT, WHERE, ORDER BY 등 어디서든 가능                  | SELECT 절 주로 사용          |
| 예시    | `CASE WHEN TLNO IS NULL THEN 'NONE' ELSE TLNO END` | `IFNULL(TLNO, 'NONE')`  |

---

## 🔍 `IS NULL` 설명

```sql
-- 잘못된 방식 (X)
WHERE TLNO = NULL

-- 올바른 방식 (O)
WHERE TLNO IS NULL
```

* `NULL`은 비교 연산자(`=`, `!=`)로 비교하지 못함
* 항상 `IS NULL` 또는 `IS NOT NULL` 사용해야 정확하게 판단됨

---
# 📌 2. 강원도에 위치한 식품공장 목록 출력하기

## 문제 설명

`FOOD_FACTORY` 테이블: 식품 공장의 정보가 담긴 테이블

### 컬럼 정보

| 컬럼명           | 타입           | 설명                 |
| ------------- | ------------ | ------------------ |
| FACTORY\_ID   | VARCHAR(10)  | 공장 ID (기본키)        |
| FACTORY\_NAME | VARCHAR(50)  | 공장 이름              |
| ADDRESS       | VARCHAR(100) | 공장 주소              |
| TLNO          | VARCHAR(20)  | 공장 전화번호 (nullable) |

---

### 요구 사항

* **강원도에 위치한 공장만 조회**
* 출력 컬럼: `FACTORY_ID`, `FACTORY_NAME`, `ADDRESS`
* **공장 ID 기준 오름차순 정렬**

---

## 문제 풀이

### 1. **강원도 필터링하기**

* 주소에서 지역 정보는 `ADDRESS` 컬럼에 포함되어 있음
* 주소가 `'강원도'`로 **시작**하는지 확인 → `LIKE '강원도%'`

```sql
WHERE ADDRESS LIKE '강원도%'
```

---

### 2. **정렬 기준**

```sql
ORDER BY FACTORY_ID ASC
```

* 공장 ID를 기준으로 **오름차순** 정렬

---

## 최종 SQL 쿼리

```sql
SELECT 
  FACTORY_ID, 
  FACTORY_NAME, 
  ADDRESS
FROM FOOD_FACTORY AS F
WHERE ADDRESS LIKE '강원도%'
ORDER BY FACTORY_ID ASC;
```

---

## 🔍 `LIKE` 연산자 설명

### 기본 문법

```sql
WHERE 컬럼 LIKE '패턴'
```

* `%`: **임의 길이의 문자열**
* `'강원도%'`: `'강원도'`로 시작하는 모든 주소에 매칭

---

# 📘 문자열 함수 요약 

## ✅ 1. `INSTR(str, substr)`

### ✔️ 설명

* `str` 문자열에서 `substr`이 \*\*처음으로 등장하는 위치(숫자)\*\*를 반환
* **위치는 1부터 시작**
* 찾는 문자열이 없으면 `0` 반환

### 📌 문법

```sql
INSTR('abcdefg', 'c')     -- 결과: 3
INSTR('apple pie', 'p')   -- 결과: 2
INSTR('apple pie', 'x')   -- 결과: 0
```

---

## ✅ 2. `LEFT(str, len)`

### ✔️ 설명

* 문자열 `str`에서 **왼쪽부터 `len`개의 문자**를 반환
* 즉, **앞에서부터 몇 글자 자를지** 지정

### 📌 문법

```sql
LEFT('abcdef', 3)   -- 결과: 'abc'
LEFT('서울시 강남구', 2)  -- 결과: '서울'
```

> 주로 `"서울"`처럼 앞 글자만 잘라내고 필터링할 때 유용

---

## ✅ 3. `SUBSTRING_INDEX(str, delim, count)`

### ✔️ 설명

* 문자열 `str`을 구분자 `delim` 기준으로 나눈 뒤,
  **앞에서부터 `count`번째까지 반환**
* `count`가 **음수이면 뒤에서부터** 처리됨

### 📌 문법

```sql
SUBSTRING_INDEX('서울시 강남구 역삼동', ' ', 1)   -- 결과: '서울시'
SUBSTRING_INDEX('서울시 강남구 역삼동', ' ', 2)   -- 결과: '서울시 강남구'
SUBSTRING_INDEX('a.b.c.d', '.', 2)              -- 결과: 'a.b'
SUBSTRING_INDEX('a.b.c.d', '.', -1)             -- 결과: 'd'
```

# 📌 3. 2021년에 출판된 인문 도서 목록 출력하기

## 문제 설명

`BOOK` 테이블에서 2021년에 출판된 `'인문'` 카테고리의 도서 정보를 조회하려고 한다.

### 📁 테이블: `BOOK`

| 컬럼명              | 타입      | 설명                 |
| ---------------- | ------- | ------------------ |
| `BOOK_ID`        | INTEGER | 도서 ID (기본 키)       |
| `CATEGORY`       | VARCHAR | 도서 카테고리 (경제, 인문 등) |
| `AUTHOR_ID`      | INTEGER | 저자 ID              |
| `PRICE`          | INTEGER | 판매 가격 (원)          |
| `PUBLISHED_DATE` | DATE    | 출판일                |

---

## 🧾 요구사항

* `CATEGORY`가 `'인문'`
* `PUBLISHED_DATE`가 **2021년**
* 출력 컬럼: `BOOK_ID`, `PUBLISHED_DATE`
* 날짜는 `YYYY-MM-DD` 형식으로 출력
* **출판일 기준 오름차순 정렬**

---

## 문제 풀이

### 1. `CATEGORY = '인문'` 조건 적용

```sql
WHERE CATEGORY = '인문'
```

### 2. `PUBLISHED_DATE`가 2021년인 도서

* `YEAR(PUBLISHED_DATE) = 2021`을 이용

```sql
WHERE YEAR(PUBLISHED_DATE) = 2021
```

### 3. 날짜 형식은 `YYYY-MM-DD`로 출력

* `DATE_FORMAT()` 함수 사용 필요

```sql
DATE_FORMAT(PUBLISHED_DATE, '%Y-%m-%d') AS PUBLISHED_DATE
```

### 4. 정렬 기준은 `PUBLISHED_DATE ASC`

---

## ✅ 최종 SQL 쿼리

```sql
SELECT 
  BOOK_ID, 
  DATE_FORMAT(PUBLISHED_DATE, '%Y-%m-%d') AS PUBLISHED_DATE
FROM BOOK
WHERE 
  YEAR(PUBLISHED_DATE) = 2021
  AND CATEGORY = '인문'
ORDER BY PUBLISHED_DATE ASC;
```

---

## 📘 날짜 관련 함수 정리

### 1. `YEAR(date)`

* 날짜에서 **연도만 추출**

```sql
YEAR('2021-03-15')  → 2021
```

---

### 2. `DATE_FORMAT(date, format)`

* 날짜를 지정된 \*\*형식(포맷)\*\*으로 출력

```sql
DATE_FORMAT(PUBLISHED_DATE, '%Y-%m-%d')
```

#### 주요 포맷 코드

| 포맷코드 | 의미       | 예시   |
| ---- | -------- | ---- |
| `%Y` | 연도 (4자리) | 2021 |
| `%y` | 연도 (2자리) | 21   |
| `%m` | 월 (2자리)  | 03   |
| `%d` | 일 (2자리)  | 15   |

#### 예시

```sql
-- 결과: '2021-03-15'
SELECT DATE_FORMAT('2021-03-15', '%Y-%m-%d');
```

---

## 기타 참고

| 함수명                        | 설명                 |
| -------------------------- | ------------------ |
| `DATE()`                   | DATETIME → DATE 추출 |
| `DATEDIFF()`               | 날짜 차이 계산 (일 단위)    |
| `DATE_FORMAT()`            | 날짜 포맷 변경           |
| `DATE_ADD()`               | 날짜 + 일정 시간         |
| `DATE_SUB()`               | 날짜 - 일정 시간         |
| `NOW()`                    | 현재 날짜와 시간          |
| `CURDATE()`                | 현재 날짜만 반환          |
| `YEAR()`/`MONTH()`/`DAY()` | 날짜에서# 연, 월, 일 추출    |



# 📌 4. 3월에 태어난 여성 회원 정보 출력하기 


## 문제 설명

회원 정보를 담은 `MEMBER_PROFILE` 테이블에서 다음 조건에 맞는 회원 정보를 조회하시오.

### 📁 테이블 구조: `MEMBER_PROFILE`

| 컬럼명             | 타입      | 설명            |
| --------------- | ------- | ------------- |
| `MEMBER_ID`     | VARCHAR | 회원 ID (기본 키)  |
| `MEMBER_NAME`   | VARCHAR | 회원 이름         |
| `TLNO`          | VARCHAR | 회원 연락처        |
| `GENDER`        | VARCHAR | 성별 (`M`, `W`) |
| `DATE_OF_BIRTH` | DATE    | 생년월일          |

---

## 🧾 요구사항

* 성별이 **여성 (`GENDER = 'W'`)**
* 생일이 **3월 (MONTH = 3)**
* **연락처(TLNO)가 없는 경우 제외**
* 출력 컬럼: `MEMBER_ID`, `MEMBER_NAME`, `GENDER`, `DATE_OF_BIRTH`
* `DATE_OF_BIRTH`는 **`YYYY-MM-DD` 형식**으로 출력
* 정렬 기준: **`MEMBER_ID` 오름차순**

---

## 문제 풀이

### 1. 성별이 여성인 회원 필터링

```sql
WHERE GENDER = 'W'
```

---

### 2. 생일이 3월인 회원 필터링

```sql
AND MONTH(DATE_OF_BIRTH) = 3
```

* `MONTH()` 함수로 생년월일에서 월만 추출

---

### 3. 전화번호(TLNO)가 NULL이 아닌 회원만

```sql
AND TLNO IS NOT NULL
```

* `NULL`은 "값이 없다"는 의미이므로, `IS NOT NULL` 조건을 써야 함
* `= NULL`은 **절대 사용 불가**! (`NULL`은 비교 불가능)

---

### 4. 생년월일은 날짜 형식 맞추기

```sql
DATE_FORMAT(DATE_OF_BIRTH, '%Y-%m-%d') AS DATE_OF_BIRTH
```

* 기본 날짜 형식이 `YYYY-MM-DD`가 아닌 DB도 있으므로, 포맷을 명시함

---

### 5. 정렬: 회원 ID 기준 오름차순

```sql
ORDER BY MEMBER_ID ASC
```

---

## ✅ 최종 SQL 쿼리

```sql
SELECT 
  MEMBER_ID, 
  MEMBER_NAME, 
  GENDER, 
  DATE_FORMAT(DATE_OF_BIRTH, '%Y-%m-%d') AS DATE_OF_BIRTH
FROM 
  MEMBER_PROFILE
WHERE 
  GENDER = 'W'
  AND MONTH(DATE_OF_BIRTH) = 3
  AND TLNO IS NOT NULL
ORDER BY 
  MEMBER_ID ASC;
```

---

## 📌 `IS NOT NULL` 상세 설명

### ▶ `IS NOT NULL`이 필요한 이유

* `NULL`은 \*\*"값이 없다"\*\*는 의미로, 비교 연산자(`=`, `!=`)로는 확인 불가
* 반드시 `IS NULL` 또는 `IS NOT NULL`을 사용

### 🔎 예시

```sql
-- 연락처가 있는 회원만 조회
WHERE TLNO IS NOT NULL

-- 연락처가 없는 회원만 조회
WHERE TLNO IS NULL
```

### ⚠️ 잘못된 예시

```sql
-- 틀린 문법: 절대 사용 금지
WHERE TLNO = NULL
```

# 📌 5. 3월의 오프라인/온라인 상품 판매 데이터 통합 출력하기


## 문제 설명

두 테이블에서 **2022년 3월**에 판매된 상품 정보를 통합해 출력하세요.

### 📂 테이블

#### ✅ `ONLINE_SALE`

* 온라인 판매 정보가 저장된 테이블
* 컬럼:

  * `ONLINE_SALE_ID`, `USER_ID`, `PRODUCT_ID`, `SALES_AMOUNT`, `SALES_DATE`

#### ✅ `OFFLINE_SALE`

* 오프라인 판매 정보가 저장된 테이블
* 컬럼:

  * `OFFLINE_SALE_ID`, `PRODUCT_ID`, `SALES_AMOUNT`, `SALES_DATE`

---

## 🎯 요구사항

* 2022년 3월의 데이터만 조회
* 컬럼: `SALES_DATE`, `PRODUCT_ID`, `USER_ID`, `SALES_AMOUNT`
* 오프라인 판매는 `USER_ID`가 없으므로 `NULL`로 표시
* 정렬 기준:

  1. 판매일 오름차순
  2. 상품 ID 오름차순
  3. 회원 ID 오름차순

---

## ✅ 최종 SQL

```sql
SELECT 
  SALES_DATE,
  PRODUCT_ID,
  USER_ID,
  SALES_AMOUNT
FROM ONLINE_SALE
WHERE YEAR(SALES_DATE) = 2022 AND MONTH(SALES_DATE) = 3

UNION ALL

SELECT 
  SALES_DATE,
  PRODUCT_ID,
  NULL AS USER_ID,
  SALES_AMOUNT
FROM OFFLINE_SALE
WHERE YEAR(SALES_DATE) = 2022 AND MONTH(SALES_DATE) = 3

ORDER BY SALES_DATE ASC, PRODUCT_ID ASC, USER_ID ASC;
```

---

##  풀이 순서 

1. 온라인 판매 테이블(ONLINE\_SALE)에서 3월 데이터 조회 → 그대로 사용
2. 오프라인 판매 테이블(OFFLINE\_SALE)도 3월 데이터 조회

   * 오프라인은 `USER_ID`가 없으니 \*\*`NULL AS USER_ID`\*\*로 맞춰줌
3. 두 테이블 구조를 동일하게 만든 후 `UNION ALL`로 합침
4. 요구된 정렬 기준대로 `ORDER BY`

---

## 📘 SQL 문법 설명

---

### 🔹 `UNION` vs `UNION ALL`

| 구문          | 설명                           |
| ----------- | ---------------------------- |
| `UNION`     | 중복 제거 후 합치기                  |
| `UNION ALL` | **중복 제거 없이** 모두 합치기 (더 빠름) ✅ |

**이 문제는 중복 제거가 필요 없기 때문에 `UNION ALL` 사용**

---

### 🔹 `NULL AS USER_ID`

* `OFFLINE_SALE` 테이블에는 `USER_ID` 컬럼이 없음
* `SELECT`문에서 맞춰주기 위해 **`NULL`을 컬럼처럼 넣고 이름을 붙임**

```sql
NULL AS USER_ID
```

즉, 컬럼은 없지만 형식을 맞추기 위해 **"없다(null)"고 명시**해주는 것

---

### 🔹 날짜 필터링 (`YEAR`, `MONTH`)

```sql
WHERE YEAR(SALES_DATE) = 2022 AND MONTH(SALES_DATE) = 3
```

* `SALES_DATE`가 **2022년 3월**에 해당하는 데이터만 필터링

---


## ✅ 핵심 포인트 요약

| 항목                | 설명                          |
| ----------------- | --------------------------- |
| `UNION ALL`       | 두 SELECT 결과를 **합쳐서 하나로 출력** |
| `NULL AS USER_ID` | 없는 컬럼을 **강제로 맞춰서 형식 통일**    |
| `YEAR`, `MONTH`   | 날짜 필터링 함수                   |
| `ORDER BY`        | 날짜 → 상품ID → 유저ID 순으로 정렬     |

