># 4-4. ë‚ ì§œ ë° ì‹œê°„ ë°ì´í„° ì´í•´í•˜ê¸°(2)(EXTRACT, DATETIME_TRUNC, PARSE_DATETIME, FORMAT_DATETIME)
- CURRENT_DATETIME([time_zone]): í˜„ì¬ DATETIME ì¶œë ¥
```
SELECT
    CURRENT_DATE() AS current_date,
    CURRENT_DATE("Asia/Seoul") AS asia_date,
    CURRENT_DATETIME() AS current_datetime,
    CURRENT_DATETIME("Asia/Seoul") AS current_datetime_asia;
```

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-05%20á„‹á…©á„’á…®%207.13.09.png)

time zoneì„ ëˆ„ë½í–ˆì„ ë•Œ, ì‹œê°„ ë° ì¼ìê°€ ë‹¬ë¼ì§€ëŠ” ê²ƒ ì£¼ì˜

- EXTRACT(part FROM datetime_expression)
**DATETIMEì—ì„œ íŠ¹ì • ì‹œê°„ í‘œí˜„ ë¶€ë¶„ë§Œ ì¶”ì¶œ(microsecond, second, minute, year ë“± ëª¨ë“  ì‹œê°„ ë‹¨ìœ„ ì¶”ì¶” ê°€ëŠ¥)**
```
SELECT
    EXTRACT(DATE FROM DATETIME "2025-05-05 19:04:15") AS date,
    EXTRACT(YEAR FROM DATETIME "2025-05-05 19:04:15") AS year,
    EXTRACT(MONTH FROM DATETIME "2025-05-05 19:04:15") AS month,
    EXTRACT(DAY FROM DATETIME "2025-05-05 19:04:15") AS day,
    EXTRACT(HOUR FROM DATETIME "2025-05-05 19:04:15") AS hour,
    EXTRACT(MINUTE FROM DATETIME "2025-05-05 19:04:15") AS minute,
    EXTRACT(DAYOFWEEK FROM DATETIME "2025-05-05 19:04:15") AS dow # ìš”ì¼ ì¶”ì¶œ(ì¼ìš”ì¼ ê¸°ì¤€)
    ;
```

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-05%20á„‹á…©á„’á…®%207.15.24.png)

- DATETIME_TRUNC
ì‹œê°„ ìë¥´ê¸° = ë‚˜ë¨¸ì§€ ë²„ë¦¼ìœ¼ë¡œ í•˜ëŠ” ê²ƒê³¼ ê°œë…ì ìœ¼ë¡œ ìœ ì‚¬...
```
eg) DATETIME_TRUNC(datetime_col, HOUR)
 -> HOURê¹Œì§€ë§Œ ë‚¨ê¸°ê³  ìë¦„

SELECT
    DATETIME "2024-10-29 19:13:47" AS original_data,
    DATETIME_TRUNC(DATETIME "2025-05-05 19:13:47", DAY) AS day_trunc,
    DATETIME_TRUNC(DATETIME "2025-05-05 19:13:47", YEAR) AS year_trunc,
    DATETIME_TRUNC(DATETIME "2025-05-05 19:13:47", MONTH) AS month_trunc,
    DATETIME_TRUNC(DATETIME "2025-05-05 19:13:47", HOUR) AS hour_trunc;
```

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-05%20á„‹á…©á„’á…®%207.19.23.png)

- PARSE_DATETIME
ë¬¸ìì—´ë¡œ ì €ì¥ëœ DATETIMEì„ DATETIME íƒ€ì…ìœ¼ë¡œ ë³€ê²½
PARSE_DATETIME('ë¬¸ìì—´ì˜ í˜•íƒœ', 'DATETIME ë¬¸ìì—´' AS datetime)
```
SELECT
    PARSE_DATETIME('%Y-%m-%d %H:%M:%S', '2025-05-05 19:19:29') AS parse_datetime;
```

- FORMAT_DATETIME
DATETIME íƒ€ì… ë°ì´í„°ë¥¼ íŠ¹ì • í˜•íƒœì˜ **ë¬¸ìì—´ ë°ì´í„°ë¡œ ë³€í™˜**í•˜ê³  ì‹¶ì€ ê²½ìš°
```
SELECT
    FORMAT_DATETIME("%c", DATETIME '2025-05-05 19:19:29') AS formatted;
```

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-05%20á„‹á…©á„’á…®%207.22.55.png)

- LAST_DAY
ì§€ì • ì‹œê°„ ë‹¨ìœ„ì˜ ë§ˆì§€ë§‰ ë‚ ì„ ì•Œê³  ì‹¶ì€ ê²½ìš°
```
SELECT
    LAST_DAY(DATETIME '2025-05-05 19:24:18') AS last_day,
    LAST_DAY(DATETIME '2025-05-05 19:24:18', MONTH) AS last_day_month,
    LAST_DAY(DATETIME '2025-05-05 19:24:18', WEEK) AS last_day_week,
    LAST_DAY(DATETIME '2025-05-05 19:24:18', WEEK(SUNDAY)) AS last_day_week_sun,
    LAST_DAY(DATETIME '2025-05-05 19:24:18', WEEK(MONDAY)) AS last_day_week_mon;
```

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-05%20á„‹á…©á„’á…®%207.26.15.png)

- DATETIME_DIFF
```
SELECT
    DATETIME_DIFF(first_datetime, second_datetime, DAY) AS day_diff1,
    DATETIME_DIFF(second_datetime, first_datetime, DAY) AS day_diff2,
    DATETIME_DIFF(first_datetime, second_datetime, MONTH) AS month_diff,
    DATETIME_DIFF(first_datetime, second_datetime, WEEK) AS week_diff
FROM (
    SELECT
        DATETIME "2025-05-05 19:32:11" AS first_datetime,
        DATETIME "2025-06-05 15:30:13" AS second_datetime
);
```
![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-05%20á„‹á…©á„’á…®%207.28.37.png)

- ì •ë¦¬
    ë‚ ì§œ ë° ì‹œê°„ ë°ì´í„°íƒ€ì…
    - DATE
    - DATETIME: íƒ€ì„ì¡´ ì •ë³´ X
    - TIMESTAMP: íƒ€ì„ì¡´ ì •ë³´ O
    - UTC
    - Milisecond: 1/1000s
    - Microsecond: 1/1000ms
    ë°ì´í„° íƒ€ì… ë³€í™˜
    - TIMESTAMP_MILLIS
    - TIMESTAMP_MICROS
    DATETIME
    - ë¬¸ìì—´->DATETIME: PARSE_DATETIME, ê·¸ ë°˜ëŒ€ëŠ” FORMAT_DATETIME
    - í˜„ì¬ DATETIME: CURRENT_DATETIME(íƒ€ì„ì¡´)
    - DATETIMEì˜ íŠ¹ì • ë¶€ë¶„ ì¶”ì¶œ: EXTRACT(íŒŒíŠ¸ FROM datetime)
    - DATETIME íŠ¹ì • ë¶€ë¶„ ìë¥´ê¸°: DATETIME_TRUNC(datetime, part)
    - DATETIME ì°¨ì´ êµ¬í•˜ê¸°: DATETIME_DIFF(ì²˜ìŒ, ë‘ë²ˆì§¸, part)



># 4-5. ì‹œê°„ ë°ì´í„° ì—°ìŠµ ë¬¸ì œ


> **1. íŠ¸ë ˆì´ë„ˆê°€ í¬ì¼“ëª¬ì„ í¬íší•œ ë‚ ì§œ(catch_date)ë¥¼ ê¸°ì¤€, 2023ë…„ 1ì›”ì— í¬íší•œ í¬ì¼“ëª¬ì˜ ìˆ˜ë¥¼ ê³„ì‚°**
```
# ì¿¼ë¦¬ ì‘ì„± ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: í¬ì¼“ëª¬ì˜ ìˆ˜
# ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: COUNT
# ë°ì´í„°ì˜ ê¸°ê°„: 2023ë…„ 1ì›” -> catch_datetime ì‚¬ìš©í•˜ê¸°(EXTRACT)
# ì‚¬ìš©í•  í…Œì´ë¸”: trainer_pokemon
# Join KEY: X
# ë°ì´í„° íŠ¹ì§•: ì§ì ‘ ë´ì•¼í•¨!!
-- catch_date: DATE íƒ€ì….
-- catch_datetime: UTC, TIMESTAMP íƒ€ì…ì„. ì»¬ëŸ¼ ì´ë¦„ê³¼ ë‹¤ë¦„(ì»¬ëŸ¼ì´ë¦„ì€ datetime but timestamp íƒ€ì…)
-- catch_datetime ê¸°ì¤€ í™•ì¸í•  í•„ìš” ìˆìŒ(í•œêµ­ì‹œê°„ì¸ì§€ UTCì¸ì§€)
-- ë³´í†µ íšŒì‚¬ì—ì„œëŠ” ë©”íƒ€ë°ì´í„°ì— ì¶”ê°€í•˜ê¸´ í•¨
-- catch_date, catch_datetime ì»¬ëŸ¼ ë¹„êµ -> DATE(DATETIME(catch_datetime, "Asia/Seoul"))
-- catch date != DATE(DATETIME(catch_Datetime, "Asia/Seoul)) => ìˆë‹¤ë©´ cathc_dateëŠ” ì‚¬ìš©í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆë‹¤.

# ë°ì´í„° ê²€ì¦(catch_date, catch_datetime ì»¬ëŸ¼ ë¹„êµ)
SELECT
    COUNT(*)
FROM(
    SELECT
        id,
        catch_date,
        DATE(DATETIME(catch_datetime, "Asia/Seoul")) AS catch_datetime_kr_date
    FROM basic.trainer_pokemon
)
WHERE
    catch_date != catch_datetime_kr_date;
# ê°™ì§€ ì•Šì€ ê²½ìš°ê°€ 141ê±´, ê°™ì€ ê²½ìš°ëŠ” 238ê±´

# 
SELECT
    COUNT(DISTINCT id) AS cnt
FROM basic.trainer_pokemon
WHERE
    EXTRACT(YEAR FROM DATETIME(catch_datetime, "Asia/Seoul")) = 2023 
    # catch_datetimeì€ TIMESTAMPë¡œ ì €ì¥ë¨->DATETIMEìœ¼ë¡œ ë³€ê²½
    AND EXTRACT(MONTH FROM DATETIME(catch_datetime, "Asia/Seoul")) = 1;
```

```
ë¬¸ì œ ì¶œì œ ì˜ë„ : ìš”ì²­í•œ ì‚¬ëŒ ë˜ëŠ” ë¬¸ì œë¥¼ ê·¸ëŒ€ë¡œ ë³¼ ê²½ìš° í‹€ë¦´ ìˆ˜ ì‡ë‹¤. 
ì»¬ëŸ¼ì„ ê¼­ íŒŒì•…í•˜ê³ (ì •ì˜í™•ì¸) ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ì!
```

> **2. ë°°í‹€ì´ ì¼ì–´ë‚œ ì‹œê°„(battle_datetime)ì„ ê¸°ì¤€ìœ¼ë¡œ, ì˜¤ì „ 6ì‹œì—ì„œ ì˜¤í›„ 6ì‹œ ì‚¬ì´ì— ì¼ì–´ë‚œ ë°°í‹€ì˜ ìˆ˜ë¥¼ ê³„ì‚°í•´ì£¼ì„¸ìš”.**
```
# ì¿¼ë¦¬ ì‘ì„± ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: ì˜¤ì „ 6ì‹œ~ì˜¤í›„ 6ì‹œ ì‚¬ì´ ì¼ì–´ë‚œ ë°°í‹€ì˜ ìˆ˜
# ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: COUNT
# ë°ì´í„°ì˜ ê¸°ê°„: ì¼ì ìƒê´€ X, ì˜¤ì „ 6ì‹œ~ì˜¤í›„ 6ì‹œë§Œ
# ì‚¬ìš©í•  í…Œì´ë¸”: battle
# Join KEY: X
# ë°ì´í„° íŠ¹ì§•: 
-- battle_date: battle_datetime ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ DATEì„.
-- battle_datetime: DATETIME
-- battle_timestamp: TIMESTAMP
-- battle_datetime, DATETIME(battle_timestamp, "Asia/Seoul") ê°™ì€ì§€ í™•ì¸í•˜ê¸°

# battle_datetime, battle_timestamp:
SELECT
    --id,
    --battle_datetime
    --DATETIME(battle_timestamp, "Asia/Seoul") AS battle_timestamp_kr,
    COUNTIF(battle_datetime = DATETIME(battle_timestamp, "Asia/Seoul")) AS battle_datetime_same_battle_timestamp_kr,
    COUNTIF(battle_datetime != DATETIME(battle_timestamp, "Asia/Seoul")) AS battle_datetime_not_same_battle_timestamp_kr
FROM basic.battle;
# ëª¨ë‘ ê°™ë‹¤ê³  ë‚˜ì˜´


SELECT
    COUNT(DISTINCT id) AS battle_cnt
FROM basic.battle
WHERE
    --EXTRACT(HOUR FROM battle_datetime) >= 6
    --AND EXTRACT(HOUR FROM battle_datetime) <= 18
    EXTRACT(HOUR FROM battle_datetime) BETWEEN 6 and 18; # ìœ„ ë‘ ì¤„ì„ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì‘ì„±
    # BETWEEN a and b: aì™€ b ì‚¬ì´ì— ìˆëŠ” ê²ƒì„ ë°˜í™˜.

# ì‹œê°„ëŒ€ë³„ë¡œ ëª‡ ê±´ì´ ìˆë‚˜
SELECT
    hour,
    COUNT(DISTINCT id) AS battle_cnt
FROM (
    SELECT
        *,
        EXTRACT(HOUR FROM battle_datetime) AS hour
    FROM basic.battle
)
GROUP BY
    hour
ORDER BY
    hour;
```

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-05%20á„‹á…©á„’á…®%207.54.58.png)

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-05%20á„‹á…©á„’á…®%207.56.12.png)

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-05%20á„‹á…©á„’á…®%207.57.41.png)

>**3. ê° íŠ¸ë ˆì´ë„ˆë³„ë¡œ ê·¸ë“¤ì´ í¬ì¼“ëª¬ì„ í¬íší•œ ì²« ë‚ (catch_date)ì„ ì°¾ê³ , ê·¸ ë‚ ì§œë¥¼ 'DD/MM/YYYY' í˜•ì‹ìœ¼ë¡œ ì¶œë ¥í•´ì£¼ì„¸ìš”. (2024-01-01=>01/01/2024)**
```
# ì¿¼ë¦¬ ì‘ì„± ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: ë‚ ì§œë¥¼ íŠ¹ì • í˜•íƒœë¡œ ë³€ê²½+í¬íší•œ ì²« ë‚ 
# ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: DATE->ë¬¸ìì—´, FORMAT_DATETIME+MIN
# ë°ì´í„°ì˜ ê¸°ê°„: x
# ì‚¬ìš©í•  í…Œì´ë¸”: trainer_pokemon
# Join KEY: X
# ë°ì´í„° íŠ¹ì§•: catch_dateëŠ” UTC ê¸°ì¤€->catch_datetime ì‚¬ìš©í•´ì•¼ í•œêµ­ ê¸°ì¤€
# ì²«ë‚  = miní•¨ìˆ˜ ì¨ì„œ ì°¾ëŠ”ë‹¤
SELECT
    trainer_id,
    FORMAT_DATE("%d/%m/%Y", min_catch_date) AS new_min_catch_date
FROM(
    SELECT
        trainer_id,
        MIN(DATE(catch_datetime, "Asia/Seoul")) AS min_catch_date
    FROM basic.trainer_pokemon
    GROUP BY
    trainer_id
)
ORDER BY
    trainer_id;

```


>**4. ë°°í‹€ì´ ì¼ì–´ë‚œ ë‚ ì§œ(battle_date)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ, ìš”ì¼ë³„ë¡œ ë°°í‹€ì´ ì–¼ë§ˆë‚˜ ìì£¼ ì¼ì–´ë‚¬ëŠ”ì§€ ê³„ì‚°í•´ì£¼ì„¸ìš”.**
```
# ì¿¼ë¦¬ ì‘ì„± ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: ìš”ì¼ë³„ë¡œ ë°°í‹€ì´ ì–¼ë§ˆë‚˜ ìì£¼ ì¼ì–´ë‚¬ëŠ”ê°€
# ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: ìš”ì¼ë³„ COUNT
# ë°ì´í„°ì˜ ê¸°ê°„: X
# ì‚¬ìš©í•  í…Œì´ë¸”: battle
# Join KEY: X
# ë°ì´í„° íŠ¹ì§•: battle_dateê°€ ì •ìƒì ì„
-- ìš”ì¼ì„ ì–´ë–»ê²Œ ì¶”ì¶œí•  ê²ƒì¸ê°€: EXTRACT
SELECT
    day_of_week,
    COUNT(DISTINCT id) AS battle_cnt
FROM(
    SELECT
    *,
    EXTRACT(DAYOFWEEK FROM battle_date) AS day_of_week
    FROM basic.battle
)
GROUP BY
    day_of_week
ORDER BY
    day_of_week;
```

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-06%20á„‹á…©á„’á…®%204.00.54.png)

>**5. íŠ¸ë ˆì´ë„ˆê°€ í¬ì¼“ëª¬ì„ ì²˜ìŒìœ¼ë¡œ í¬íší•œ ë‚ ì§œì™€ ë§ˆì§€ë§‰ìœ¼ë¡œ í¬íší•œ ë‚ ì§œì˜ ê°„ê²©ì´ í° ìˆ˜ëŠ¥ë¡œ ì •ë ¬í•˜ëŠ” ì¿¼ë¦¬ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.**
```
# ì¿¼ë¦¬ ì‘ì„± ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: ì²˜ìŒê³¼ ë§ˆì§€ë§‰ì˜ diff í° ìˆœìœ¼ë¡œ ì •ë ¬
# ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: ì²˜ìŒ í¬íší•œ ë‚ ì§œ(MIN), ë§ˆì§€ë§‰ í¬íš ë‚ ì§œ(MAX)ì°¨ì´(DATETIME_DIFF)->ì°¨ì´ í° ìˆœìœ¼ë¡œ ì •ë ¬(ORDER BY)
# ë°ì´í„°ì˜ ê¸°ê°„: X
# ì‚¬ìš©í•  í…Œì´ë¸”: trainer_pokemon
# Join KEY: X
# ë°ì´í„° íŠ¹ì§•: catch_dateëŠ” UTC ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ ì¼ì, catch_datetime ì‚¬ìš©í•´ì•¼ í•¨

SELECT
    *,
    DATETIME_DIFF(max_catch_datetime, min_catch_datetime, DAY) AS diff
FROM(
    SELECT
        trainer_id,
        MIN(DATETIME(catch_datetime, "Asia/Seoul")) AS min_catch_datetime,
        MAX(DATETIME(catch_datetime, "Asia/Seoul")) AS max_catch_datetime
    FROM basic.trainer_pokemon
    GROUP BY
        trainer_id
)
ORDER BY
    diff DESC;
```

># 4-6. ì¡°ê±´ë¬¸(CASE WHEN, IF)
- ì¡°ê±´ë¬¸
    - ë§Œì•½ íŠ¹ì • ì¡°ê±´ì´ ì¶©ì¡±ë˜ë©´, ì–´ë–¤ í–‰ë™ì„ í•˜ì
    - íŠ¹ì • ì¡°ê±´ì´ ì°¸ì¼ ë•Œ A, ì•„ë‹ˆë©´ B
    -   ì¡°ê±´ì— ë”°ë¥¸ ë¶„ê¸° ì²˜ë¦¬ê°€ í•„ìš”í•œ ê²½ìš°
    - ì¡°ê±´ì— ë”°ë¼ ë‹¤ë¥¸ ê°’ì„ í‘œì‹œí•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©(1->ì¼ìš”ì¼, 2->ì›”ìš”ì¼ ë“±ë“±..)

- ì¡°ê±´ë¬¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
    1) CASE WHEN
    2) IF

- ì¡°ê±´ë¬¸ í•¨ìˆ˜ê°€ ì‚¬ìš©ë˜ëŠ” ì´ìœ 
    1) íŠ¹ì • ì¹´í…Œê³ ë¦¬ë¥¼ í•˜ë‚˜ë¡œ í•©ì¹˜ëŠ” ì „ì²˜ë¦¬ê°€ í•„ìš”í•  ìˆ˜ ìˆìŒ  
        eg) 1~6í•™ë…„ -> ì €,ê³ í•™ë…„ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ê²½ìš°    
    2) ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ìª½ê³¼ ë¶„ì„í•˜ëŠ” ìª½ì´ ë‚˜ë‰˜ê³ , ë¶„ì„í•  ë•Œ í•„ìš”í•œ ë¶€ë¶„ì—ì„œ ì¡°ê±´ ì„¤ì •í•´ì„œ ë³€ê²½í•˜ëŠ” ê²ƒì´ ë” ìœ ìš©í•¨(ì €ì¥ì‹œ rawê¸‰ìœ¼ë¡œí•˜ëŠ”ê²Œ ë‹¹ì—°íˆ ë” ë‚«ë‹¤)

1) CASE WHEN
- ì—¬ëŸ¬ ì¡°ê±´ì´ ìˆì„ ê²½ìš° ìœ ìš©
- ë¬¸ë²•
```
SELECT
    CASE
    WHEN ì¡°ê±´1 THEN ì¡°ê±´ 1ì´ ì°¸ì¼ ê²½ìš° ê²°ê³¼
    WHEN ì¡°ê±´2 THEN ì¡°ê±´ 2ì´ ì°¸ì¼ ê²½ìš° ê²°ê³¼
    ELSE ê·¸ ì™¸ ì¡°ê±´ì¼ ê²½ìš° ê²°ê³¼
END AS ìƒˆë¡œìš´_ì»¬ëŸ¼_ì´ë¦„
```
ì˜ˆì‹œ) Rock íƒ€ì…ê³¼ Ground íƒ€ì…ì´ ë¹„ìŠ·: Rock&Groundë¼ëŠ” íƒ€ì…ì„ ìƒˆë¡œ ë§Œë“¤ì–´ë³´ì
```
# ì¿¼ë¦¬ ì‘ì„± ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: typeì´ Rock ë˜ëŠ” Groundë©´ Rock&Groundë¼ê³  ìˆ˜ì •
# ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: CASE WHEN
# ë°ì´í„°ì˜ ê¸°ê°„: X
# ì‚¬ìš©í•  í…Œì´ë¸”: pokemon
# Join KEY: X
# ë°ì´í„° íŠ¹ì§•: typeì´ type1, type2ë¡œ ë‚˜ë‰˜ì–´ ë‘ íƒ€ì… ëª¨ë‘ ê³ ë ¤í•´ì•¼ í•¨

SELECT
    new_type1,
    COUNT(DISTINCT id) AS pokemon_cnt
    FROM(
    SELECT
        *,
        CASE
            WHEN type1 IN ("Rock", "Ground") OR type2 IN ("Rock", "Ground") THEN "Rock&Ground"
        ELSE type1
        END AS new_type1
    FROM basic.pokemon
    )
GROUP BY
    new_type1
```
![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-06%20á„‹á…©á„’á…®%204.39.02.png)

**CASE WHENì€ ìˆœì„œê°€ ì¤‘ìš”!**
```
# ê° í¬ì¼“ëª¬ì˜ ê³µê²©ë ¥(attack)ì„ ê¸°ì¤€ìœ¼ë¡œ, 50 ì´ìƒì´ë©´ 'Strong', 100 ì´ìƒì´ë©´ 'Very Strong', ê·¸ ì´í•˜ë©´ 'Weak'ìœ¼ë¡œ ë¶„ë¥˜

SELECT
    eng_name,
    attack,
    CASE
        WHEN attack >= 50 THEN 'Strong' # ì²«ë²ˆì§¸ ì¡°ê±´ì´ ë¨¼ì € ê±¸ë¦¼
        WHEN attack >= 100 THEN 'Very Strong'
        ELSE 'Weak'
    END AS attack_level
FROM basic.pokemon
```
![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-06%20á„‹á…©á„’á…®%204.43.52.png)

2) IF
**ë‹¨ì¼ ì¡°ê±´**ì¼ ë•Œ ìœ ìš©

ë¬¸ë²•
- IF(ì¡°ê±´ë¬¸, Trueì¼ ë•Œ ê°’, Falseì¼ ë•Œ ê°’) AS ìƒˆë¡œìš´_ì»¬ëŸ¼_ì´ë¦„

SELECT
    IF(1=1, 'ë™ì¼í•œ ê²°ê³¼', 'ë™ì¼í•˜ì§€ ì•Šì€ ê²°ê³¼') AS result1,
    IF(1=2, 'ë™ì¼í•œ ê²°ê³¼', 'ë™ì¼í•˜ì§€ ì•Šì€ ê²°ê³¼') AS result2)



># 4-7. ì¡°ê±´ë¬¸ ì—°ìŠµ ë¬¸ì œ

> **1. í¬ì¼“ëª¬ì˜ 'speed'ê°€ 70 ì´ìƒì´ë©´ 'ë¹ ë¦„', ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ 'ëŠë¦¼'ìœ¼ë¡œ í‘œì‹œí•˜ëŠ” ìƒˆë¡œìš´ ì»¬ëŸ¼ 'Speed_Category'ë¥¼ ë§Œë“¤ì–´ì£¼ì„¸ìš”.**
```
# ì¿¼ë¦¬ ì‘ì„± ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: Speed ì»¬ëŸ¼ì„ ì‚¬ìš©í•´ ìƒˆë¡œìš´ Speed_Category ë§Œë“¤ê¸°
# ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: CASE WHEN, IF->ì¡°ê±´ì´ ë‹¨ì¼ì´ë¯€ë¡œ IF, 70 ì´ìƒ.
# ë°ì´í„°ì˜ ê¸°ê°„: X
# ì‚¬ìš©í•  í…Œì´ë¸”: pokemon
# Join KEY: X
# ë°ì´í„° íŠ¹ì§•: min_speed 5, max_speed 140

SELECT
    id,
    kor_name,
    speed,
    IF(speed >= 70, "ë¹ ë¦„", "ëŠë¦¼") AS Speed_Category
FROM basic.pokemon
```

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-06%20á„‹á…©á„’á…®%207.31.18.png)

>**2. í¬ì¼“ëª¬ì˜ 'type1'ì— ë”°ë¼ 'Water', 'Fire', 'Electric' íƒ€ì…ì€ ê°ê° 'ë¬¼', 'ë¶ˆ', 'ì „ê¸°'ë¡œ, ê·¸ ì™¸ íƒ€ì…ì€ 'ê¸°íƒ€'ë¡œ ë¶„ë¥˜í•˜ëŠ” ìƒˆë¡œìš´ ì»¬ëŸ¼ 'type_Korean'ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”.**

```
# ì¿¼ë¦¬ ì‘ì„± ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: type2ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ê²ƒì˜ ê°’ ë³€ê²½, ê¸°íƒ€->type_Korean
# ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: CASE WHEN, IF-> ì—¬ëŸ¬ ì¡°ê±´ ìˆìœ¼ë¯€ë¡œ CASE WHEN
# ë°ì´í„°ì˜ ê¸°ê°„: X
# ì‚¬ìš©í•  í…Œì´ë¸”: pokemon
# Join KEY: X
# ë°ì´í„° íŠ¹ì§•: íƒ€ì…ì´ ì—¬ëŸ¬ê°€ì§€

SELECT
    id,
    kor_name,
    type1,
    CASE
        WHEN type1 = "Water" THEN "ë¬¼"
        WHEN type1 = "Fire" THEN "ë¶ˆ"
        WHEN type1 = "Electric" THEN "ì „ê¸°"
        ELSE "ê¸°íƒ€"
    END AS type1_Korean
FROM basic.pokemon

```

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-06%20á„‹á…©á„’á…®%207.32.36.png)

>**3. ê° í¬ì¼“ëª¬ì˜ ì´ì ì„ ê¸°ì¤€ìœ¼ë¡œ, 300 ì´í•˜ë©´ 'Low', 301ì—ì„œ 500 ì‚¬ì´ë©´ 'Medium', 501 ì´ìƒì´ë©´ 'High'ë¡œ ë¶„ë¥˜í•´ì£¼ì„¸ìš”.**
```
# ì¿¼ë¦¬ ì‘ì„± ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: total ì»¬ëŸ¼->ì¡°ê±´ì— ë§ëŠ” ê°’ ë³€ê²½
# ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: CASE WHEN
# ë°ì´í„°ì˜ ê¸°ê°„: X
# ì‚¬ìš©í•  í…Œì´ë¸”: pokemon
# Join KEY: X
# ë°ì´í„° íŠ¹ì§•: total ì»¬ëŸ¼ì´ ì •ìˆ˜

SELECT
  id,
  kor_name,
  total,
    CASE
      WHEN total >= 501 THEN "High"
      WHEN total BETWEEN (300 AND 500) THEN "Medium"
      ELSE "Low"
    END as total_grade
FROM basic.pokemon
# between ì ˆì—ëŠ” ì†Œê´„í˜¸ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤
```

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-06%20á„‹á…©á„’á…®%207.39.14.png)


>**4. ê° íŠ¸ë ˆì´ë„ˆì˜ ë°°ì§€ ê°œìˆ˜(badge_count)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ, 5ê°œ ì´í•˜ë©´ 'Beginner', 6ê°œì—ì„œ 8ê°œ ì‚¬ì´ë©´ 'Intermediate', ê·¸ ì´ìƒì´ë©´ 'Advanced'ë¡œ ë¶„ë¥˜í•´ì£¼ì„¸ìš”.**
```
# ì¿¼ë¦¬ ì‘ì„± ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: badge_count -> ì¡°ê±´ ë§Œì¡±í•˜ëŠ” ê°’ ë³€ê²½
# ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: CASE WHEN
# ë°ì´í„°ì˜ ê¸°ê°„: X
# ì‚¬ìš©í•  í…Œì´ë¸”: trainer
# Join KEY: X
# ë°ì´í„° íŠ¹ì§•: X

SELECT
    id,
    name,
    badge_count,
    CASE
        WHEN badge_count >= 9 THEN "Advanced"
        WHEN badge_count BETWEEN 6 AND 8 THEN "Intermediate"
    ELSE "Beginner"
    END AS trainer_level
FROM basic.trainer
```
>**4-1) íŠ¸ë ˆì´ë„ˆ ë ˆë²¨ë³„ë¡œ ì–¼ë§ˆë‚˜ ìˆëŠ”ì§€ í™•ì¸í•˜ê¸°**
```
SELECT
  trainer_level,
  COUNT(DISTINCT id) AS trainer_cnt
FROM(
SELECT
    id,
    name,
    badge_count,
    CASE
        WHEN badge_count >= 9 THEN "Advanced"
        WHEN badge_count BETWEEN 6 AND 8 THEN "Intermediate"
    ELSE "Beginner"
    END AS trainer_level
FROM basic.trainer)
GROUP BY
  trainer_level
```

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-06%20á„‹á…©á„’á…®%207.40.37.png)
![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-06%20á„‹á…©á„’á…®%207.43.38.png)

>**5. íŠ¸ë ˆì´ë„ˆê°€ í¬ì¼“ëª¬ì„ í¬íší•œ ë‚ ì§œ(catch_date)ê°€ '2023-01-01' ì´í›„ì´ë©´ 'Recent', ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ 'Old'ë¡œ ë¶„ë¥˜í•´ì£¼ì„¸ìš”.**
```
# ì¿¼ë¦¬ ì‘ì„± ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: í¬íší•œ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ê°’ ë³€ê²½
# ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: IF
# ë°ì´í„°ì˜ ê¸°ê°„: X
# ì‚¬ìš©í•  í…Œì´ë¸”: trainer_pokemon
# Join KEY: X
# ë°ì´í„° íŠ¹ì§•: catch_dateëŠ” UTC ê¸°ì¤€, catch_datetimeì€ TIMESTAMP

SELECT
    id,
    trainer_id,
    pokemon_id,
    catch_datetime,
    IF(DATE(catch_datetime, "Asia/Seoul")>="2023-01-01", "Recent", "Old") AS recent_or_old
FROM basic.trainer_pokemon

```


>**6. ë°°í‹€ì—ì„œ ìŠ¹ì(winner_id)ê°€ player1_idì™€ ê°™ìœ¼ë©´ 'Player 1 Wins', player2_idì™€ ê°™ìœ¼ë©´ 'Player2 Wins', ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ 'Draw'ë¡œ ê²°ê³¼ê°€ ë‚˜ì˜¤ê²Œ í•´ì£¼ì„¸ìš”.**
```
# ì¿¼ë¦¬ ì‘ì„± ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: ìŠ¹íŒ¨ ì—¬ë¶€ë¥¼ ì•Œ ìˆ˜ ìˆëŠ” ì»¬ëŸ¼ ë§Œë“¤ê¸°
# ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: CASE WHEN
# ë°ì´í„°ì˜ ê¸°ê°„: X
# ì‚¬ìš©í•  í…Œì´ë¸”: battle
# Join KEY: X
# ë°ì´í„° íŠ¹ì§•: X

SELECT
    id,
    winner_id,
    player1_id,
    player2_id,
    CASE
        WHEN winner_id = player1_id THEN "Player 1 Wins"
        WHEN winner_id = player2_id THEN "Player 2 Wins"
    ELSE "Draw"
    END AS battle_result
FROM basic.battle
```

![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-06%20á„‹á…©á„’á…®%207.51.38.png)


># 4-8. ì •ë¦¬


- ìˆ«ì
    - ì‚¬ì¹™ì—°ì‚°
    - SAFE_DIVIDE
- ë¬¸ì
    - CONCAT
    - SPLIT
    - REPLACE
    - TRIM
    - UPPER
- ì‹œê°„, ë‚ ì§œ
    - EXTRACT(HOUR FROM datetime)
    - DATETIME_TRUNC
    - PARSE_DATETIME
    - FORMAT_DATETIME
    - UTC, DATETIME, TIMESTAMP
- Bool(T/F)
- ë°ì´í„° íƒ€ì… ë³€ê²½í•˜ê¸°(SAFE_CAST)
- ì¡°ê±´ë¬¸: íŠ¹ì • ì¡°ê±´ì´ë©´ ë³€ê²½
    - CASE WHEN
    - IF


># 4-9. BiQuery ê³µì‹ ë¬¸ì„œ í™•ì¸í•˜ëŠ” ë²•
- ê¸°ìˆ ëª…+documentationìœ¼ë¡œ ê²€ìƒ‰



**ğŸ“ì§„ë„ Check**  
![alt text](../Assignment_25_1/images/w4/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º%202025-05-06%20á„‹á…©á„’á…®%208.05.55.png)



